#import streamlit as st import pandas as pd import random import requests from bs4 import BeautifulSoup from urllib.parse import quote # Page setup st.set_page_config(page_title="TikTok Remix Finder", layout="wide") st.title("ğŸ§ TikTok Remix Finder â€” Find Trending Songs to Remix") # --------------------------------------- # Function: Fetch TikTok trending songs # --------------------------------------- @st.cache_data(ttl=3600) def fetch_kworb_tiktok_top(country_code="US", top_n=25): """Fetch top TikTok trending songs from Kworb.net""" url = f"https://kworb.net/charts/tiktok/{country_code.lower()}.html" r = requests.get(url) r.raise_for_status() soup = BeautifulSoup(r.text, "html.parser") table = soup.find("table") if table is None: st.error("Could not find chart table â€” layout might have changed.") return pd.DataFrame() songs = [] for row in table.find_all("tr")[1:top_n+1]: cols = [c.get_text(strip=True) for c in row.find_all("td")] if len(cols) >= 3: rank, artist, title = cols[:3] songs.append({"rank": rank, "artist": artist, "title": title}) df = pd.DataFrame(songs) # Add YouTube & Spotify search links df["YouTube"] = df.apply( lambda r: f"https://www.youtube.com/results?search_query={quote(r['artist']+' '+r['title'])}", axis=1, ) df["Spotify"] = df.apply( lambda r: f"https://open.spotify.com/search/{quote(r['artist']+' '+r['title'])}", axis=1, ) return df # --------------------------------------- # Sidebar filters # --------------------------------------- st.sidebar.header("Filters") region = st.sidebar.selectbox("Region", ["US", "UK", "DE", "FR", "Global"]) keyword = st.sidebar.text_input("Search by artist or title", "") # --------------------------------------- # Main data fetch + Update button # --------------------------------------- if "df" not in st.session_state: st.session_state.df = fetch_kworb_tiktok_top(region, 25) if st.sidebar.button("ğŸ”„ Update Song List"): with st.spinner("Updating song list..."): st.session_state.df = fetch_kworb_tiktok_top(region, 25) st.success("Song list updated!") df = st.session_state.df.copy() # --------------------------------------- # Genre and BPM filter bar # --------------------------------------- st.subheader("ğŸšï¸ Quick Genre Filters") genres = { "House (120â€“128 BPM)": (120, 128), "Techno (125â€“135 BPM)": (125, 135), "Trap / Drill (130â€“150 BPM)": (130, 150), "Drum & Bass (160â€“180 BPM)": (160, 180), "Dubstep (138â€“142 BPM)": (138, 142), "Trance (130â€“140 BPM)": (130, 140), } cols = st.columns(len(genres)) selected_genre = None for i, (genre, bpm_range) in enumerate(genres.items()): if cols[i].button(genre): selected_genre = genre st.info(f"Filtering for songs suited for **{genre}** range: {bpm_range[0]}â€“{bpm_range[1]} BPM") # --------------------------------------- # Apply filters # --------------------------------------- if keyword: df = df[df.apply(lambda r: keyword.lower() in (r["artist"] + r["title"]).lower(), axis=1)] # (Genre buttons currently display BPM range info only, # but you could later integrate Spotify metadata to actually match BPM.) # --------------------------------------- # Show data # --------------------------------------- st.dataframe(df[["rank", "artist", "title", "YouTube", "Spotify"]]) # --------------------------------------- # Random Song Picker # --------------------------------------- st.markdown("### ğŸ² Random Song Picker") if st.button("Give me a random song to remix"): if len(df) > 0: random_song = df.sample(1).iloc[0] st.success(f"Your remix challenge: **{random_song['title']}** by **{random_song['artist']}**") st.markdown( f"[ğŸ§ Listen on YouTube]({random_song['YouTube']}) | [ğŸµ Find on Spotify]({random_song['Spotify']})" ) else: st.warning("No songs available. Try updating or changing filters.") st.caption( "Data from Kworb TikTok Charts â€¢ Genre BPM ranges for EDM reference â€¢ Built with â¤ï¸ using Streamlit"
